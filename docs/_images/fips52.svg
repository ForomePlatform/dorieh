<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 10.0.1 (20240210.2158)
 -->
<!-- Pages: 1 -->
<svg width="2824pt" height="799pt"
 viewBox="0.00 0.00 2824.38 799.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 795)">
<polygon fill="white" stroke="none" points="-4,4 -4,-795 2820.38,-795 2820.38,4 -4,4"/>
<!-- medicare.qc_enrl_bene.fips5 -->
<g id="node1" class="node">
<title>medicare.qc_enrl_bene.fips5</title>
<g id="a_node1"><a xlink:href="../medicare.qc_enrl_bene/fips5.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="1356.38,-59 1163.88,-59 1163.88,0 1356.38,0 1356.38,-59"/>
<text text-anchor="start" x="1176.88" y="-37.7" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare.qc_enrl_bene.fips5</text>
<polygon fill="none" stroke="black" points="1174.88,-7 1174.88,-29.5 1345.38,-29.5 1345.38,-7 1174.88,-7"/>
<text text-anchor="start" x="1177.88" y="-13.2" font-family="Times,serif" font-size="14.00">(MAX(fips2) || MAX(fips3))</text>
<polygon fill="none" stroke="black" points="1171.88,-4 1171.88,-55 1348.38,-55 1348.38,-4 1171.88,-4"/>
</a>
</g>
</g>
<!-- medicare.enrollments.fips3 -->
<g id="node2" class="node">
<title>medicare.enrollments.fips3</title>
<g id="a_node2"><a xlink:href="../medicare.enrollments/fips3.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="1488.25,-155 1304,-155 1304,-96 1488.25,-96 1488.25,-155"/>
<text text-anchor="start" x="1317" y="-133.7" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare.enrollments.fips3</text>
<polygon fill="none" stroke="black" points="1315,-103 1315,-125.5 1477.25,-125.5 1477.25,-103 1315,-103"/>
<text text-anchor="start" x="1318" y="-109.2" font-family="Times,serif" font-size="14.00">MAX(fips3)</text>
<polygon fill="none" stroke="black" points="1312,-100 1312,-151 1480.25,-151 1480.25,-100 1312,-100"/>
</a>
</g>
</g>
<!-- medicare.enrollments.fips3&#45;&gt;medicare.qc_enrl_bene.fips5 -->
<g id="edge1" class="edge">
<title>medicare.enrollments.fips3&#45;&gt;medicare.qc_enrl_bene.fips5</title>
<path fill="none" stroke="black" d="M1354.21,-95.53C1340.51,-86.06 1325.14,-75.44 1310.86,-65.57"/>
<polygon fill="black" stroke="black" points="1313.13,-62.88 1302.91,-60.07 1309.15,-68.64 1313.13,-62.88"/>
<text text-anchor="middle" x="1374.25" y="-72.45" font-family="Times,serif" font-size="14.00">	join natural</text>
</g>
<!-- medicare._enrollments.fips3 -->
<g id="node3" class="node">
<title>medicare._enrollments.fips3</title>
<g id="a_node3"><a xlink:href="../medicare._enrollments/fips3.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="1568.62,-251 1377.62,-251 1377.62,-192 1568.62,-192 1568.62,-251"/>
<text text-anchor="start" x="1390.62" y="-229.7" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare._enrollments.fips3</text>
<polygon fill="none" stroke="black" points="1388.62,-199 1388.62,-221.5 1557.62,-221.5 1557.62,-199 1388.62,-199"/>
<text text-anchor="start" x="1391.62" y="-205.2" font-family="Times,serif" font-size="14.00">MAX(fips3)</text>
<polygon fill="none" stroke="black" points="1385.62,-196 1385.62,-247 1560.62,-247 1560.62,-196 1385.62,-196"/>
</a>
</g>
</g>
<!-- medicare._enrollments.fips3&#45;&gt;medicare.enrollments.fips3 -->
<g id="edge2" class="edge">
<title>medicare._enrollments.fips3&#45;&gt;medicare.enrollments.fips3</title>
<path fill="none" stroke="black" d="M1449.39,-191.53C1442.23,-182.78 1434.26,-173.05 1426.71,-163.84"/>
<polygon fill="black" stroke="black" points="1429.65,-161.9 1420.6,-156.38 1424.23,-166.34 1429.65,-161.9"/>
<text text-anchor="middle" x="1454.62" y="-168.45" font-family="Times,serif" font-size="14.00">Copied</text>
</g>
<!-- medicare._ps.fips3 -->
<g id="node4" class="node">
<title>medicare._ps.fips3</title>
<g id="a_node4"><a xlink:href="../medicare._ps/fips3.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="2816.38,-397.75 431.88,-397.75 431.88,-338.75 2816.38,-338.75 2816.38,-397.75"/>
<text text-anchor="start" x="1569.75" y="-376.45" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare._ps.fips3</text>
<polygon fill="none" stroke="black" points="442.88,-345.75 442.88,-368.25 2805.38,-368.25 2805.38,-345.75 442.88,-345.75"/>
<text text-anchor="start" x="445.88" y="-351.95" font-family="Times,serif" font-size="14.00">CASE WHEN ssa3 is NOT NULL THEN &#160;CASE WHEN year &gt; 2010 THEN &#160;&#160;&#160;&#160;&#160;(SELECT fips3 from public.ssa as s where ps.ssa3 = s.ssa3 and ps.year = s.year and ps.fips2 = s.fips2 ORDER BY 1 DESC LIMIT 1) &#160;&#160;&#160;ELSE &#160;&#160;&#160;&#160;&#160;(SELECT fips3 from public.ssa as s where ps.ssa3 = s.ssa3 and 2003 = s.year and ps.fips2 = s.fips2 ORDER BY 1 DESC LIMIT 1) &#160;ENDELSE &#160;(SELECT public.zip_to_fips3(year, zip))END AS fips3</text>
<polygon fill="none" stroke="black" points="439.88,-342.75 439.88,-393.75 2808.38,-393.75 2808.38,-342.75 439.88,-342.75"/>
</a>
</g>
</g>
<!-- medicare._ps.fips3&#45;&gt;medicare._enrollments.fips3 -->
<g id="edge3" class="edge">
<title>medicare._ps.fips3&#45;&gt;medicare._enrollments.fips3</title>
<path fill="none" stroke="blue" stroke-width="5" d="M1593.93,-338.31C1571.2,-316.51 1539.76,-286.38 1514.66,-262.31"/>
<polygon fill="blue" stroke="blue" stroke-width="5" points="1518.02,-259.47 1507.77,-255.71 1511.96,-265.79 1518.02,-259.47"/>
<text text-anchor="middle" x="1636.5" y="-264.45" font-family="Times,serif" font-size="14.00">	 &#160;Aggregated On bene_id, year, state</text>
</g>
<!-- medicare.ps.fips2 -->
<g id="node5" class="node">
<title>medicare.ps.fips2</title>
<g id="a_node5"><a xlink:href="../medicare.ps/fips2.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="1069.25,-646 655,-646 655,-485.5 1069.25,-485.5 1069.25,-646"/>
<text text-anchor="start" x="811.12" y="-624.7" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare.ps.fips2</text>
<text text-anchor="start" x="702.62" y="-578.2" font-family="Times,serif" font-size="14.00">2 digit state FIPS, see https://en.wikip</text>
<text text-anchor="start" x="691" y="-561.7" font-family="Times,serif" font-size="14.00">edia.org/wiki/Federal_Information_Proces</text>
<text text-anchor="start" x="736" y="-545.2" font-family="Times,serif" font-size="14.00">sing_Standard_state_code</text>
<polygon fill="none" stroke="black" points="666,-492.5 666,-515 1058.25,-515 1058.25,-492.5 666,-492.5"/>
<text text-anchor="start" x="669" y="-498.7" font-family="Times,serif" font-size="14.00">(SELECT fips2 FROM public.us_states as s WHERE s.ssa2 = &quot;state&quot;)</text>
<polygon fill="none" stroke="black" points="663,-489.5 663,-642 1061.25,-642 1061.25,-489.5 663,-489.5"/>
</a>
</g>
</g>
<!-- medicare.ps.fips2&#45;&gt;medicare._ps.fips3 -->
<g id="edge4" class="edge">
<title>medicare.ps.fips2&#45;&gt;medicare._ps.fips3</title>
<path fill="none" stroke="black" d="M1069.59,-511.52C1207.38,-476.17 1383.68,-430.94 1500.07,-401.08"/>
<polygon fill="black" stroke="black" points="1500.86,-404.49 1509.68,-398.61 1499.12,-397.71 1500.86,-404.49"/>
<text text-anchor="middle" x="1281.75" y="-461.95" font-family="Times,serif" font-size="14.00"> &#160;Transformed</text>
</g>
<!-- medicare._ps.fips2 -->
<g id="node12" class="node">
<title>medicare._ps.fips2</title>
<g id="a_node12"><a xlink:href="../medicare._ps/fips2.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="414.25,-448.5 0,-448.5 0,-288 414.25,-288 414.25,-448.5"/>
<text text-anchor="start" x="152.75" y="-427.2" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare._ps.fips2</text>
<text text-anchor="start" x="47.62" y="-380.7" font-family="Times,serif" font-size="14.00">2 digit state FIPS, see https://en.wikip</text>
<text text-anchor="start" x="36" y="-364.2" font-family="Times,serif" font-size="14.00">edia.org/wiki/Federal_Information_Proces</text>
<text text-anchor="start" x="81" y="-347.7" font-family="Times,serif" font-size="14.00">sing_Standard_state_code</text>
<polygon fill="none" stroke="black" points="11,-295 11,-317.5 403.25,-317.5 403.25,-295 11,-295"/>
<text text-anchor="start" x="14" y="-301.2" font-family="Times,serif" font-size="14.00">(SELECT fips2 FROM public.us_states as s WHERE s.ssa2 = &quot;state&quot;)</text>
<polygon fill="none" stroke="black" points="8,-292 8,-444.5 406.25,-444.5 406.25,-292 8,-292"/>
</a>
</g>
</g>
<!-- medicare.ps.fips2&#45;&gt;medicare._ps.fips2 -->
<g id="edge12" class="edge">
<title>medicare.ps.fips2&#45;&gt;medicare._ps.fips2</title>
<path fill="none" stroke="black" d="M654.69,-514.04C584.29,-495.77 505.16,-474.06 425.27,-449.13"/>
<polygon fill="black" stroke="black" points="426.54,-445.86 415.95,-446.21 424.44,-452.54 426.54,-445.86"/>
<text text-anchor="middle" x="505.62" y="-461.95" font-family="Times,serif" font-size="14.00">Copied</text>
</g>
<!-- medicare.ps.ssa3 -->
<g id="node6" class="node">
<title>medicare.ps.ssa3</title>
<g id="a_node6"><a xlink:href="../medicare.ps/ssa3.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="1621.88,-625.5 1344.38,-625.5 1344.38,-506 1621.88,-506 1621.88,-625.5"/>
<text text-anchor="start" x="1434" y="-604.2" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare.ps.ssa3</text>
<text text-anchor="start" x="1380.38" y="-557.7" font-family="Times,serif" font-size="14.00">Social Security Administration (SSA)</text>
<text text-anchor="start" x="1410.75" y="-541.2" font-family="Times,serif" font-size="14.00">three digit code for county</text>
<polygon fill="none" stroke="black" points="1352.38,-510 1352.38,-621.5 1613.88,-621.5 1613.88,-510 1352.38,-510"/>
</a>
</g>
</g>
<!-- medicare.ps.ssa3&#45;&gt;medicare._ps.fips3 -->
<g id="edge5" class="edge">
<title>medicare.ps.ssa3&#45;&gt;medicare._ps.fips3</title>
<path fill="none" stroke="black" d="M1525.81,-505.56C1548.9,-473.56 1576.72,-434.98 1596.87,-407.04"/>
<polygon fill="black" stroke="black" points="1599.49,-409.39 1602.5,-399.23 1593.81,-405.29 1599.49,-409.39"/>
<text text-anchor="middle" x="1592.75" y="-461.95" font-family="Times,serif" font-size="14.00"> &#160;Transformed</text>
</g>
<!-- medicare.ps.ssa3_parent -->
<g id="node7" class="node">
<title>medicare.ps.ssa3_parent</title>
<g id="a_node7"><a xlink:href="../medicare.ps/ssa3.html" xlink:title="8 incoming links (columns)" target="_blank">
<path fill="yellow" stroke="black" d="M1591.12,-781.18C1591.12,-786.6 1542.72,-791 1483.12,-791 1423.53,-791 1375.12,-786.6 1375.12,-781.18 1375.12,-781.18 1375.12,-692.82 1375.12,-692.82 1375.12,-687.4 1423.53,-683 1483.12,-683 1542.72,-683 1591.12,-687.4 1591.12,-692.82 1591.12,-692.82 1591.12,-781.18 1591.12,-781.18"/>
<path fill="none" stroke="black" d="M1591.12,-781.18C1591.12,-775.76 1542.72,-771.36 1483.12,-771.36 1423.53,-771.36 1375.12,-775.76 1375.12,-781.18"/>
<text text-anchor="middle" x="1483.12" y="-731.95" font-family="Times,serif" font-size="14.00">8 incoming links (columns)</text>
</a>
</g>
</g>
<!-- medicare.ps.ssa3_parent&#45;&gt;medicare.ps.ssa3 -->
<g id="edge6" class="edge">
<title>medicare.ps.ssa3_parent&#45;&gt;medicare.ps.ssa3</title>
<path fill="none" stroke="goldenrod" stroke-width="6" d="M1483.12,-682.91C1483.12,-669.88 1483.12,-655.69 1483.12,-641.84"/>
<polygon fill="goldenrod" stroke="goldenrod" stroke-width="6" points="1488.38,-642.29 1483.13,-632.29 1477.88,-642.29 1488.38,-642.29"/>
</g>
<!-- medicare.ps.year -->
<g id="node8" class="node">
<title>medicare.ps.year</title>
<g id="a_node8"><a xlink:href="../medicare.ps/year.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="2758,-629.5 1640.25,-629.5 1640.25,-502 2758,-502 2758,-629.5"/>
<text text-anchor="start" x="2149.25" y="-608.2" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare.ps.year</text>
<text text-anchor="start" x="1676.25" y="-561.7" font-family="Times,serif" font-size="14.00">Beneficiary Enrollment Reference Year</text>
<polygon fill="none" stroke="black" points="1651.25,-509 1651.25,-531.5 2747,-531.5 2747,-509 1651.25,-509"/>
<text text-anchor="start" x="1654.25" y="-515.2" font-family="Times,serif" font-size="14.00">(CASE WHEN &quot;year&quot;::int &lt; 20 THEN (2000 + &quot;year&quot;::int) WHEN (20 &lt; &quot;year&quot;::int AND &quot;year&quot;::int &lt; 100) THEN (1900 + &quot;year&quot;::int) WHEN &quot;year&quot; IS NULL THEN 2000 ELSE &quot;year&quot;::int END)</text>
<polygon fill="none" stroke="black" points="1648.25,-506 1648.25,-625.5 2750,-625.5 2750,-506 1648.25,-506"/>
</a>
</g>
</g>
<!-- medicare.ps.year&#45;&gt;medicare._ps.fips3 -->
<g id="edge7" class="edge">
<title>medicare.ps.year&#45;&gt;medicare._ps.fips3</title>
<path fill="none" stroke="black" d="M2013.23,-501.55C1915.42,-468.29 1799.59,-428.91 1719.89,-401.81"/>
<polygon fill="black" stroke="black" points="1721.41,-398.63 1710.81,-398.72 1719.16,-405.26 1721.41,-398.63"/>
<text text-anchor="middle" x="1950.75" y="-461.95" font-family="Times,serif" font-size="14.00"> &#160;Transformed</text>
</g>
<!-- medicare.ps.year_parent -->
<g id="node9" class="node">
<title>medicare.ps.year_parent</title>
<g id="a_node9"><a xlink:href="../medicare.ps/year.html" xlink:title="8 incoming links (columns)" target="_blank">
<path fill="yellow" stroke="black" d="M2307.12,-781.18C2307.12,-786.6 2258.72,-791 2199.12,-791 2139.53,-791 2091.12,-786.6 2091.12,-781.18 2091.12,-781.18 2091.12,-692.82 2091.12,-692.82 2091.12,-687.4 2139.53,-683 2199.12,-683 2258.72,-683 2307.12,-687.4 2307.12,-692.82 2307.12,-692.82 2307.12,-781.18 2307.12,-781.18"/>
<path fill="none" stroke="black" d="M2307.12,-781.18C2307.12,-775.76 2258.72,-771.36 2199.12,-771.36 2139.53,-771.36 2091.12,-775.76 2091.12,-781.18"/>
<text text-anchor="middle" x="2199.12" y="-731.95" font-family="Times,serif" font-size="14.00">8 incoming links (columns)</text>
</a>
</g>
</g>
<!-- medicare.ps.year_parent&#45;&gt;medicare.ps.year -->
<g id="edge8" class="edge">
<title>medicare.ps.year_parent&#45;&gt;medicare.ps.year</title>
<path fill="none" stroke="goldenrod" stroke-width="6" d="M2199.12,-682.91C2199.12,-671.18 2199.12,-658.51 2199.12,-646"/>
<polygon fill="goldenrod" stroke="goldenrod" stroke-width="6" points="2204.38,-646.18 2199.13,-636.18 2193.88,-646.18 2204.38,-646.18"/>
</g>
<!-- medicare.enrollments.fips2 -->
<g id="node10" class="node">
<title>medicare.enrollments.fips2</title>
<g id="a_node10"><a xlink:href="../medicare.enrollments/fips2.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="1210.25,-155 1026,-155 1026,-96 1210.25,-96 1210.25,-155"/>
<text text-anchor="start" x="1039" y="-133.7" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare.enrollments.fips2</text>
<polygon fill="none" stroke="black" points="1037,-103 1037,-125.5 1199.25,-125.5 1199.25,-103 1037,-103"/>
<text text-anchor="start" x="1040" y="-109.2" font-family="Times,serif" font-size="14.00">MAX(fips2)</text>
<polygon fill="none" stroke="black" points="1034,-100 1034,-151 1202.25,-151 1202.25,-100 1034,-100"/>
</a>
</g>
</g>
<!-- medicare.enrollments.fips2&#45;&gt;medicare.qc_enrl_bene.fips5 -->
<g id="edge9" class="edge">
<title>medicare.enrollments.fips2&#45;&gt;medicare.qc_enrl_bene.fips5</title>
<path fill="none" stroke="black" d="M1161.89,-95.53C1176.33,-85.97 1192.54,-75.24 1207.57,-65.29"/>
<polygon fill="black" stroke="black" points="1209.08,-68.49 1215.49,-60.05 1205.22,-62.65 1209.08,-68.49"/>
<text text-anchor="middle" x="1235.25" y="-72.45" font-family="Times,serif" font-size="14.00">	join natural</text>
</g>
<!-- medicare._enrollments.fips2 -->
<g id="node11" class="node">
<title>medicare._enrollments.fips2</title>
<g id="a_node11"><a xlink:href="../medicare._enrollments/fips2.html" xlink:title="&lt;TABLE&gt;" target="_blank">
<polygon fill="none" stroke="black" points="1208.62,-251 1017.62,-251 1017.62,-192 1208.62,-192 1208.62,-251"/>
<text text-anchor="start" x="1030.62" y="-229.7" font-family="Times,serif" font-weight="bold" font-size="14.00">medicare._enrollments.fips2</text>
<polygon fill="none" stroke="black" points="1028.62,-199 1028.62,-221.5 1197.62,-221.5 1197.62,-199 1028.62,-199"/>
<text text-anchor="start" x="1031.62" y="-205.2" font-family="Times,serif" font-size="14.00">MAX(fips2)</text>
<polygon fill="none" stroke="black" points="1025.62,-196 1025.62,-247 1200.62,-247 1200.62,-196 1025.62,-196"/>
</a>
</g>
</g>
<!-- medicare._enrollments.fips2&#45;&gt;medicare.enrollments.fips2 -->
<g id="edge10" class="edge">
<title>medicare._enrollments.fips2&#45;&gt;medicare.enrollments.fips2</title>
<path fill="none" stroke="black" d="M1114.67,-191.53C1115.08,-183.68 1115.54,-175.05 1115.99,-166.7"/>
<polygon fill="black" stroke="black" points="1119.48,-166.9 1116.52,-156.72 1112.49,-166.52 1119.48,-166.9"/>
<text text-anchor="middle" x="1135.62" y="-168.45" font-family="Times,serif" font-size="14.00">Copied</text>
</g>
<!-- medicare._ps.fips2&#45;&gt;medicare._enrollments.fips2 -->
<g id="edge11" class="edge">
<title>medicare._ps.fips2&#45;&gt;medicare._enrollments.fips2</title>
<path fill="none" stroke="blue" stroke-width="5" d="M414.62,-290C417.46,-289.31 420.3,-288.64 423.12,-288 623.62,-242.5 863.85,-228.56 1001.46,-224.32"/>
<polygon fill="blue" stroke="blue" stroke-width="5" points="1001.21,-228.7 1011.08,-224.04 1000.96,-219.96 1001.21,-228.7"/>
<text text-anchor="middle" x="630.5" y="-264.45" font-family="Times,serif" font-size="14.00">	 &#160;Aggregated On bene_id, year, state</text>
</g>
</g>
</svg>
